var dialog,waitingDialog=function(e){return{show:function(t,i,n){var a=e.extend({dialogSize:"m",progressType:"",hasbtn:n.hasbtn},n);"undefined"==typeof t&&(t="Loading"),"undefinded"==typeof i&&(i="Notification"),"undefined"==typeof n&&(n={});var o='<p style="text-align:center; font-size: 18px; color:white;  line-height: 1.25; font-weight: 400;">'+t+"</p>";a.progressType&&(o=o+'<div class="progress progress-striped active progress-bar-'+a.progressType+'" style="margin:5px;"><div class="progress-bar" style="width: 100%"></div></div>'),a.hasbtn&&(o+='<button type="button" class="btn btn-primary" style="padding: 2px 4px; margin-left:165px; margin-right:165px; font-weight: 400" onclick="waitingDialog.hide()">OK</button>'),dialog=e.jsPanel({id:"modal_msg",paneltype:"modal",theme:"black",content:o,title:i,size:{width:400,height:100},callback:function(e){e.content.css("")}})},hide:function(){null!=dialog&&dialog.close()},exist:function(){return null!=dialog?!0:void 0}}}(jQuery),aboutDialog=function(e){return{show:function(){var t=e('<div class="col-md-12">        <h3>          About HiC3D-Viewer        </h3>        <p class="text-justify">          <code>HiC3D-Viewer</code>is a user-friendly tool designed to explore Hi-C data         in a 3D fashion. It is based on          <code>            <a href="threejs.org">thress.js</a>          </code>for the visualization and          <code>            <a href="https://github.com/hiclib/pastis">Pastis</a>          </code>for module prediction</p>        <p class="text-center text-info">          <a class="btn btn-primary btn-large">User manual</a>          <a class="btn btn-large btn-primary">Download</a>        </p></div>');aboutPanel=e.jsPanel({id:"about_panel",title:"HiC3D-Viewer",size:{width:400,height:200},position:"center",content:t,theme:"medium",paneltype:{type:"modal",mode:"default"},selector:"#aboutPanel"})}}}(jQuery),hicDialog=function(e){var t,i=null,n=null,a=function(t){var i=.98*e("svg#hicPanel_hicFrq").parent().width(),n=.88*e("svg#hicPanel_hicFrq").parent().height(),a=d3.select("svg#hicPanel_hicFrq").attr("width",i).attr("height",n);e("svg#hicPanel_hicFrq").empty(),a.append("svg:image").attr("width",i).attr("height",n).attr("viewBox","0 0"+i+" "+n).attr("id","hicPanel_hicImg").attr("preserveAspectRatio","none").attr("xlink:href",t)},o=null,r=null,s=null,l=null,c=function(){function i(e){var i=c.extent().length,n=t[parseInt(o.chr)-1][parseInt(r.chr)-1][i];n&&e.attr("fill",d3.rgb(255*n.r,255*n.g,255*n.b))}function n(){if(c.empty()){var t=e.Event("clearHic");return void e(document).trigger(t)}var i=c.extent(),t=e.Event("regionSelected");t.Xcoord=new Array,t.Ycoord=new Array,t.chr1=e("#hicPanel_chromosome1").val(),t.chr2=e("#hicPanel_chromosome2").val();i.forEach(function(e){var i=Math.ceil(e[0][0]),n=Math.ceil(e[1][0]),a=Math.ceil(e[0][1]),o=Math.ceil(e[1][1]),r={start:i,end:n},s={start:a,end:o};t.Xcoord.push(r),t.Ycoord.push(s)}),e(document).trigger(t)}var a=e("svg#hicPanel_hicFrq").width();s=d3.scale.linear().domain([0,o.len]).range([0,a]),l=d3.scale.linear().domain([r.len,0]).range([0,a]);{var c=d3.svg.multibrush().x(s).y(l).extentAdaption(i).on("brushend",n);d3.select("svg#hicPanel_hicFrq").append("g").attr("class","brush").call(c).selectAll("rect")}};return{show:function(t,s,l,d,p){if(null!=i&s==n)return void this.updatImg(l,d);this.hide(),"undefined"==typeof t&&(t="Hi-C heatmap"),n=s;var h=e('<div class="row" style="margin:0px;"><div class="col-md-5" style="padding: 0px" ><div class="form-group" style="margin: 0px;">  <div class="input-group">    <span class="input-group-addon" style="color: black; background: white;font-size: 12px;font-weight: bold; padding: 0px;border: 0px;">chr1 (X axis)</span>    <span class="input-group-btn">      <select id="hicPanel_chromosome1" class="form-control" type="select" style=" padding:0px; margin:0px 45px 0px 0px"></select>    </span>  </div></div></div><div class="col-md-5" style="padding: 0px"><div class="form-group" style="margin: 0px;">  <div class="input-group">    <span class="input-group-addon" style="color: black; background: white;font-size: 12px;font-weight: bold; padding: 0px;border: 0px;">chr2 (Y axis)</span>    <span class="input-group-btn">      <select id="hicPanel_chromosome2" class="form-control" type="select" style=" padding: 0px; margin: 0px 45px 0px 0px;"></select>    </span>  </div></div></div><div class="col-md-1"><button class="btn btn-success btn-sm" id="getHiC" style="padding: 5px 5px 0px 5px; margin-top: 5px">OK</button></div></div><svg id="hicPanel_hicFrq" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg>');i=e.jsPanel({resizable:{handles:"e, s, w, se, sw"},overflow:"scroll",id:"hic_panel",title:t,size:{width:350,height:315},position:"bottom right",content:h,theme:"light",selector:"#displayContainer"}),i.on("jspanelloaded",function(t,i){"hic_panel"==i&&(d.length>0&&e.each(d,function(t,i){"undefined"!=typeof i&&(1==i.displayed&&(1&i.displayedChr&&(o=i),2&i.displayedChr&&(r=i)),e("#hicPanel_chromosome1").append(e("<option></option>").attr("value",i.chr).text(p[parseInt(i.chr)-1])),e("#hicPanel_chromosome2").append(e("<option></option>").attr("value",i.chr).text(p[parseInt(i.chr)-1])))}),e("#hicPanel_chromosome1").val(o.chr),e("#hicPanel_chromosome2").val(r.chr),e("button#getHiC").click(function(){var t=e.Event("chrChanged");t.chr1=e("#hicPanel_chromosome1").val(),t.chr2=e("#hicPanel_chromosome2").val(),e(document).trigger(t)}),"undefined"!=typeof l&&(a(l),c()))})},setColor:function(e){t=e},updatImg:function(t,i){"undefined"!=typeof t&&(e.each(i,function(e,t){"undefined"!=typeof t&&1==t.displayed&&(1&t.displayedChr&&(o=t),2&t.displayedChr&&(r=t))}),a(t),c())},hide:function(){null!=i&&i.close()}}}(jQuery);